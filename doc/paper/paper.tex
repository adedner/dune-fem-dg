\documentclass{ansarticle}

\title{Preparing articles for submission to the \\
       Archive of Numerical Software}
\author[1]{Editor O. Archive\thanks{Additional thanks to my neighbor's dog
  for waking me up on time to work on this style file}}
\author[2]{Author O. Software}
\affil[1]{The Archive of Numerical Software}
\affil[2]{The Worlds Best Place for Numerical Software}
\runningtitle{Preparing articles for ANS}
\runningauthor{Archive Editors}

\input{macros}

%------------------------------------------------------------------------------
\begin{document}

\maketitle

\begin{abstract}
We discuss the matrix-free
implementation of Discontinuous Galerkin methods for compressible flow
problems, i.e. the compressible Navier-Stokes equations. For the spatial discretization
the CDG2 method and for temporal discretization an explicit Runge-Kutta method is used.
For the presented matrix-free approach we discuss asynchronous communication,
shared memory parallelization, and automated code generation to increase the
floating point performance of the code.
\end{abstract}

%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\section{Introduction}



%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\section{Governing Equations}
\label{sec:equations}
The system we investigate is governed by the
viscous compressible flow equations in $\theta$-form,
for example, described in \cite{GR08}.
For $\Omega \subset \RRR^d$, $d=1,2,3$, these equations can be written in the form
\begin{eqnarray}
\label{eqn:general}
\label{eqn:ns}
\partial_t \vecU  &=& \oper{L}(\vecU) \qquad \mbox{ in } (0,T] \times \Omega, \\
\vecU(0,\cdot) &=& \vecU_0(\cdot) \qquad  \mbox{ in } \Omega, \nonumber 
\end{eqnarray}
with $$\oper{L}(\vecU) := - \nabla \cdot\big( \mathcal{F}(\vecU) -
\mathcal{A}(\vecU,\nabla\vecU) \big) + \mathcal{S}(\vecU)$$
and suitable boundary conditions.

\todo{Here U should not be specified yet.}
The vector of conservative variables is $\vecU=(\rho, \rho\vecv, \rho\theta)^\trans$.
$\rho$ is the density, $\theta$ the potential temperature, and
$\vecv=(v_1,...,v_d)^T$ the velocity field.
$\mathcal{F}(\vecU) = (\mathcal{F}_i(\vecU))$ and
$\mathcal{A}(\vecU)\nabla\vecU = ((\mathcal{A}(\vecU)\nabla \vecU)_i )$ for $i=1,...,d$, are
given as follows:
\begin{equation}
   \mathcal{F}_i(\vecU)=\left(\begin{array}{c}
    \rho v_i \\
    \rho v_1 v_i  + \delta_{1i}p \\
    \vdots \\
    \rho v_d v_i + \delta_{di} p \\
    v_i \rho\theta  \\
  \end{array}\right),\qquad 
  \big (\mathcal{A}(\vecU)\nabla\vecU \big )_i =\mu\rho\left(\begin{array}{c}
    0                \\
    \partial_i v_1   \\ 
    \vdots           \\ 
    \partial_i v_d   \\
    \partial_i\theta \\
  \end{array}\right).
\end{equation}
with $\mu$ being the kinematic viscosity.
The source term $\mathcal{S}$ is only acting on the last component of the velocity field, i.e.
$\mathcal{S}(\vecU) = (0,...,0,-\rho g,0)^T$ with
$g$ being the constant of the gravitation force.
To close the system we define the pressure $p$ in accordance with the
ideal gas law $p = p_0\left(\frac{\rho\gasconst\theta}{p_0}\right)^\gamma$,
where $\gamma=c_p/c_v$ is the heat capacity ratio and $c_p$ and $c_v$ are specific
heat capacities under constant pressure and volume, respectively.
The individual gas constant is defined as $\gasconst=c_p-c_v$.
%In equation (\ref{eqn:eos}) 
%$p_0$ is the standard reference pressure,
For the standard reference pressure $p_0$ we choose $p_0=10^5$~Pa.


%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
% Discretization
\input{dg}

%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
% Implementation
\section{Implementation}
\subsection{Problem selector (rename?)}

\subsection{Problem}
\subsection{Model}
\subsection{Stepper}

\subsection{Adaptivity}
\subsection{Parallelization}
\subsection{I/O}

%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
% Numerical Examples 
\input{numerics}

\bibliographystyle{abbrvnat}
\bibliography{bibliography}
\end{document}
